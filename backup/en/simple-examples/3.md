# Document System for Domain Expert Agent

This example demonstrates a **workflow that provides documents to an AI agent for professional analysis**. Using legal documents as an example, you can see the process of the agent answering questions by referencing the document content.

## Core Idea: Document + Agent

The core of this workflow is **including external documents in the agent's system prompt**:

```yaml
version: "agentflow/v1"
kind: "WorkflowSpec"
metadata:
  name: "Document-Based Expert Agent"
  description: "Domain expert AI that references document content"
  version: "0.1.0"

agents:
  - id: "lawyer_agent"
    inline:
      type: "agent"
      model: "openai/gpt-4.1-mini"
      system_prompt: |
        You are a lawyer.
        Answer the questions based on the content of the document below.
        Please include references in your answer.

        Provide your answer in JSON format.
        Example:
        {
          "answer": "The answer is OOO.",
          "references": [
            "Document1",
            "Document2"
          ]
        }

        <help>
          Use the document name attribute to indicate your references.
        </help>

        <document name="Genius act">
          {{{documents.genius_act.content}}}
        </document>

nodes:
  start:
    type: "agent_task"
    agent: "lawyer_agent"
    next: "end"

  end:
    type: "end"
```

## How the Document System Works

The core of using documents in the workflow is the `{{{documents.genius_act.content}}}` template syntax:

```javascript
const documents = {
  'genius_act': {
    type: 'markdown',
    filters: [new RemoveBase64ImageFilter()], // Remove images
    content: readFileSync('./docs/Genius act.md', 'utf-8')
  }
};

const workflow = new Workflow({
  mainWorkflow: workflowYaml,
  documents, // Pass documents
  responseFilters: [new RemoveMarkdownJsonFilter()] // Clean up JSON response
});
```

## Actual Execution Result

```javascript
const result = await workflow.ask("Why did the United States propose this bill?");
```

**Actual Response:**
```json
{
  "answer": "The main purpose of the United States proposing this bill, the GENIUS Act of 2025, is to systematize the regulation and ensure the stability of payment stablecoins. The bill sets clear standards for the issuance and operation of stablecoins to guarantee the safety and soundness of the financial system, strengthen consumer protection, and manage risks to financial stability.",
  "references": [
    "Genius act - SECTION 1. Short title.",
    "Genius act - SEC. 3. Limitation on who may issue a payment stablecoin.",
    "Genius act - SEC. 4. Requirements for issuing payment stablecoins.",
    "Genius act - SEC. 6. Supervision and enforcement with respect to subsidiaries of insured depository institutions and Comptroller-regulated entities.",
    "Genius act - SEC. 8. Customer protection.",
    "Genius act - SEC. 9. Treatment of insolvent payment stablecoin issuers."
  ]
}
```

**Execution Statistics:**
```
Total execution time: 7.15 seconds
Node execution: start(7087ms) -> end(0ms)
Response filter: Markdown code block removed
```

## Other Use Cases

This document system can be applied to other domains as well:

### Medical Document Analysis
```yaml
<document name="Clinical Trial Report">
  {{{documents.clinical_report.content}}}
</document>
```

### Technical Document Analysis
```yaml
<document name="API Specification">
  {{{documents.api_spec.content}}}
</document>
```

### Contract Review
```yaml
<document name="Contract">
  {{{documents.contract.content}}}
</document>
```

## Key Points

1. **Document Injection**: Include documents in the system prompt using `{{{documents.key.content}}}` syntax
2. **Filtering**: Preprocessing possible such as removing Base64 images
3. **Structured Response**: Provide answers and reference information in JSON format
4. **Domain Expertise**: Agent performs the role of a specialist in a particular field

This is the core of SowonFlow's **Document System for Domain Expert Agent**.