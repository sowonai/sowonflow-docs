# Email Management Workflow Using Gmail MCP Server

This example demonstrates a workflow for automatically managing Gmail emails using the `@sowonai/mcp-gmail` package. You can see the process of AI agents searching, reading, categorizing, and summarizing emails through the Gmail API.

> **Source Code**: The `@sowonai/mcp-gmail` package is open source. You can view the source code on [GitHub](https://github.com/sowonlabs/mcp-servers/tree/main/packages/gmail).

## Workflow Configuration

```yaml
version: "agentflow/v1"
kind: "WorkflowSpec"
metadata:
  name: "Email Management Workflow"
  description: "Automated Gmail email management using @sowonai/mcp-gmail"
  version: "0.1.0"

agents:
  - id: "gmail_assistant"
    inline:
      type: "agent"
      model: "openai/gpt-4.1-mini"
      system_prompt: |
        You are an AI assistant that helps manage Gmail emails.
        Use MCP tools to answer the user's questions. (MCP tools have the "mcp__" prefix)
        Separate and process business emails and personal emails, and ignore promotional emails.

        Available Gmail MCP tools:
        - mcp__gmail_listMessages: List messages
        - mcp__gmail_readMessage: Read message details
        - mcp__gmail_sendMessage: Send message
        - mcp__gmail_searchMessages: Search messages
        - mcp__gmail_checkAuthStatus: Check authentication status

        <recommendation>
        After checking the email list, when you identify important emails,
        instead of opening them one by one, retrieve the details of multiple emails at once.
        </recommendation>

        <information>
        Our company is SowonLabs, established on March 11, 2025.
        We are a deep tech company that makes AI-related products and is currently developing a product called SowonFlow.
        This product is an AI-based automated YAML workflow engine.
        </information>
      mcp: ["gmail"]

nodes:
  start:
    type: "agent_task"
    agent: "gmail_assistant"
    next: "end"

  end:
    type: "end"
```

## MCP Server Setup

To run this workflow, you need to set up the MCP server as follows:

```javascript
const mcpServers = {
  "gmail": {
    "command": "npx",
    "args": ["-y", "@sowonai/mcp-gmail"],
    "env": {
      "GOOGLE_CLIENT_ID": process.env.GOOGLE_CLIENT_ID,
      "GOOGLE_CLIENT_SECRET": process.env.GOOGLE_CLIENT_SECRET,
      "GOOGLE_REFRESH_TOKEN": process.env.GOOGLE_REFRESH_TOKEN
    }
  }
};
```

## Environment Variable Setup

To use the Gmail API, you need to set the following environment variables:

```bash
# Google OAuth settings
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REFRESH_TOKEN=your_refresh_token
```

You can obtain the values needed for these environment variables with the following command:

```sh
npx @sowonai/mcp-gmail --install --credentials ./credentials.json
```

## Usage Examples

### 1. Check Recent Business Emails

```
"Find and summarize any business-related emails from the recent mail."
```

### 2. Search Emails from a Specific Sender

```
"Find all emails sent from example@company.com."
```

### 3. Search Emails with Attachments

```
"Find emails with attachments and tell me their subjects and senders."
```

### 4. Search Emails by Date Range

```
"Summarize important emails from yesterday to today."
```

## Gmail Search Syntax

This workflow supports Gmail's powerful search syntax:

* `from:sender@example.com` - Specific sender
* `to:recipient@example.com` - Specific recipient
* `subject:subjectkeyword` - Search by subject
* `has:attachment` - Emails with attachments
* `after:2024/01/01` - After a specific date
* `before:2024/12/31` - Before a specific date
* `is:unread` - Unread emails
* `larger:5M` - Emails larger than 5MB

## Example Execution Results

When running the workflow, you can get results like the following:

```
ðŸ“§ Business email summary:

1. **Change in Project Meeting Schedule** (john@company.com)
   - Tomorrow's 3 PM meeting moved to 4 PM
   - Zoom link attached

2. **SowonFlow Beta Test Results** (beta@partner.com)
   - Performance test results report
   - 3 improvement suggestions

3. **Contract Review Request** (legal@vendor.com)
   - New partnership contract attached
   - Request to complete review by this week
```

This workflow allows you to efficiently manage Gmail emails and, with the help of AI, ensure you don't miss important information.