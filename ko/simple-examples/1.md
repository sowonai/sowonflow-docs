# Gmail MCP 서버를 활용한 이메일 관리 워크플로우

이 예제는 `@sowonai/mcp-gmail` 패키지를 사용하여 Gmail 이메일을 자동으로 관리하는 워크플로우를 보여줍니다. AI 에이전트가 Gmail API를 통해 이메일을 검색, 읽기, 분류하고 요약하는 과정을 확인할 수 있습니다.

## 워크플로우 구성

```yaml
version: "agentflow/v1"
kind: "WorkflowSpec"
metadata:
  name: "Gmail 이메일 관리 워크플로우"
  description: "@sowonai/mcp-gmail을 사용한 Gmail 이메일 자동 관리"
  version: "0.1.0"

agents:
  - id: "gmail_assistant"
    inline:
      type: "agent"
      model: "openai/gpt-4.1-mini"
      system_prompt: |
        당신은 Gmail 이메일 관리를 도와주는 AI 어시스턴트입니다.
        MCP 도구를 사용하여 사용자의 질문에 답변해주세요. (MCP 도구는 "mcp__" 접두사가 있습니다)
        
        업무 관련 이메일과 개인 이메일을 분리하여 처리하고, 광고성 이메일은 무시하세요.

        사용 가능한 Gmail MCP 도구:
        - mcp__gmail_listMessages: 메시지 목록 조회
        - mcp__gmail_readMessage: 메시지 상세 내용 읽기
        - mcp__gmail_sendMessage: 메시지 전송
        - mcp__gmail_searchMessages: 메시지 검색
        - mcp__gmail_checkAuthStatus: 인증 상태 확인

        <권장사항>
        이메일 목록을 확인한 후, 중요한 이메일을 식별했을 때는
        하나씩 열어보는 대신 한 번에 여러 이메일의 상세 내용을 가져오세요.
        </권장사항>

        <회사정보>
        우리 회사는 SowonLabs이며, 2025년 3월 11일에 설립되었습니다.
        AI 관련 제품을 만드는 딥테크 회사이며, 현재 SowonFlow라는 제품을 개발하고 있습니다.
        이 제품은 AI 기반 자동화 YAML 워크플로우 엔진입니다.
        </회사정보>
      mcp: ["gmail"]

nodes:
  start:
    type: "agent_task"
    agent: "gmail_assistant"
    next: "end"
  
  end:
    type: "end"
```

## MCP 서버 설정

이 워크플로우를 실행하려면 다음과 같이 MCP 서버를 설정해야 합니다:

```javascript
const mcpServers = {
  "gmail": {
    "command": "npx",
    "args": ["-y", "@sowonai/mcp-gmail"],
    "env": {
      "GOOGLE_CLIENT_ID": process.env.GOOGLE_CLIENT_ID,
      "GOOGLE_CLIENT_SECRET": process.env.GOOGLE_CLIENT_SECRET,
      "GOOGLE_REFRESH_TOKEN": process.env.GOOGLE_REFRESH_TOKEN
    }
  }
};
```

## 환경 변수 설정

Gmail API를 사용하기 위해 다음 환경 변수들을 설정해야 합니다:

```bash
# Google OAuth 설정
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REFRESH_TOKEN=your_refresh_token
```

## 사용 예시

### 1. 최근 업무 이메일 확인
```
"최근 메일 중에 업무 관련한 어떤 메일이 있는지 찾아서 요약해줘."
```

### 2. 특정 발신자 이메일 검색
```
"example@company.com에서 온 이메일을 모두 찾아줘."
```

### 3. 첨부파일이 있는 이메일 검색
```
"첨부파일이 있는 이메일들을 찾아서 제목과 발신자를 알려줘."
```

### 4. 날짜 범위로 이메일 검색
```
"어제부터 오늘까지의 중요한 이메일들을 요약해줘."
```

## Gmail 검색 문법

이 워크플로우는 Gmail의 강력한 검색 문법을 지원합니다:

- `from:sender@example.com` - 특정 발신자
- `to:recipient@example.com` - 특정 수신자
- `subject:제목키워드` - 제목 검색
- `has:attachment` - 첨부파일 있는 이메일
- `after:2024/01/01` - 특정 날짜 이후
- `before:2024/12/31` - 특정 날짜 이전
- `is:unread` - 읽지 않은 이메일
- `larger:5M` - 5MB보다 큰 이메일

## 실행 결과 예시

워크플로우 실행 시 다음과 같은 결과를 얻을 수 있습니다:

```
📧 업무 관련 이메일 요약:

1. **프로젝트 미팅 일정 변경** (john@company.com)
   - 내일 오후 3시 미팅이 4시로 연기됨
   - Zoom 링크 첨부

2. **SowonFlow 베타 테스트 결과** (beta@partner.com)
   - 성능 테스트 결과 보고서
   - 3개의 개선사항 제안

3. **계약서 검토 요청** (legal@vendor.com)
   - 새로운 파트너십 계약서 첨부
   - 금주 내 검토 완료 요청
```

이 워크플로우를 통해 Gmail 이메일을 효율적으로 관리하고, AI의 도움으로 중요한 정보를 놓치지 않을 수 있습니다.
