# ë„ë©”ì¸ ì „ë¬¸ê°€ AI ì—ì´ì „íŠ¸ë¥¼ í™œìš©í•œ ë¬¸ì„œ ë¶„ì„ ì›Œí¬í”Œë¡œìš°

ì´ ì˜ˆì œëŠ” ë²•ë¥  ë„ë©”ì¸ ì „ë¬¸ê°€ AI ì—ì´ì „íŠ¸ë¥¼ í™œìš©í•˜ì—¬ ë³µì¡í•œ ë²•ë¥  ë¬¸ì„œë¥¼ ë¶„ì„í•˜ê³  ì§ˆë¬¸ì— ë‹µë³€í•˜ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ë¬¸ì„œ í•„í„°ë§ê³¼ ì‘ë‹µ ì²˜ë¦¬ ê¸°ëŠ¥ì„ í†µí•´ ë³´ë‹¤ ì •í™•í•˜ê³  êµ¬ì¡°í™”ëœ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì›Œí¬í”Œë¡œìš° êµ¬ì„±

```yaml
version: "agentflow/v1"
kind: "WorkflowSpec"
metadata:
  name: "ë„ë©”ì¸ ì „ë¬¸ê°€ ë¬¸ì„œ ë¶„ì„ ì›Œí¬í”Œë¡œìš°"
  description: "ë²•ë¥  ì „ë¬¸ê°€ AIë¥¼ í™œìš©í•œ ë¬¸ì„œ ë¶„ì„ ë° ì§ˆì˜ì‘ë‹µ"
  version: "0.1.0"

agents:
  - id: "lawyer_agent"
    inline:
      type: "agent"
      model: "openai/gpt-4.1-mini"
      system_prompt: |
        ë‹¹ì‹ ì€ ë²•ë¥  ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
        ì•„ë˜ ë¬¸ì„œì˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”.
        ë‹µë³€ì—ëŠ” ë°˜ë“œì‹œ ì°¸ì¡°í•œ ë¬¸ì„œë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”.

        JSON í˜•íƒœë¡œ ë‹µë³€ì„ ì œê³µí•´ì£¼ì„¸ìš”.
        ì˜ˆì‹œ:
        {
          "answer": "ë‹µë³€ ë‚´ìš©ì…ë‹ˆë‹¤.",
          "references": [
            "ë¬¸ì„œ1",
            "ë¬¸ì„œ2"
          ] 
        }
        
        <ë„ì›€ë§>  
          ì°¸ì¡° ë¬¸ì„œë¥¼ í‘œì‹œí•  ë•ŒëŠ” ë¬¸ì„œì˜ name ì†ì„±ì„ ì‚¬ìš©í•˜ì„¸ìš”.
        </ë„ì›€ë§>

        <document name="Genius act">
          {{{documents.genius_act.content}}}
        </document>

nodes:
  start:
    type: "agent_task"
    agent: "lawyer_agent"
    next: "end"
  
  end:
    type: "end"
```

## ë¬¸ì„œ í•„í„°ë§ ì„¤ì •

ì´ ì›Œí¬í”Œë¡œìš°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì„œ í•„í„°ë§ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

### 1. Base64 ì´ë¯¸ì§€ ì œê±° í•„í„°
```javascript
import { RemoveBase64ImageFilter } from '../src/utils/document-filters';

const documents = {
  'genius_act': {
    type: 'markdown',
    filters: [new RemoveBase64ImageFilter()], // Base64 ì¸ì½”ë”©ëœ ì´ë¯¸ì§€ ì œê±°
    content: readFileSync(path.resolve(__dirname, './docs/Genius act.md'), 'utf-8')
  }
};
```

### 2. ë§ˆí¬ë‹¤ìš´ JSON ì‘ë‹µ í•„í„°
```javascript
import { RemoveMarkdownJsonFilter } from '../src/utils/response-filters';

// ì›Œí¬í”Œë¡œìš° ìƒì„± ì‹œ ì‘ë‹µ í•„í„° ì ìš©
const workflow = new Workflow({
  mainWorkflow: workflowYaml,
  documents,
  responseFilters: [new RemoveMarkdownJsonFilter()] // ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡ ì œê±°
});
```

## í…ŒìŠ¤íŠ¸ êµ¬ì„±

### í™˜ê²½ ì„¤ì •
```javascript
// í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
import { loadTestEnv } from './utils/env-loader';
loadTestEnv();

// ì„¤ì • ìƒì„±
const testConfig = createConfig({
  llmBaseUrl: `${baseUrl}/ai/v1/spaces/${spaceId}`,
  llmApiKey: process.env.SOWONAI_API_KEY,
  llmModelName: 'mistralai/mistral-small-3.2-24b-instruct:free',
  llmTemperature: 0.7,
  llmTimeout: 60000,
  llmMaxRetries: 2,
  logLevel: 'debug'
});
```

### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜
```bash
# SowonAI API ì„¤ì •
SOWONAI_BASE_URL=http://localhost:3030
SOWONAI_SPACE_ID=spc_sowonlabs
SOWONAI_API_KEY=your_api_key_here
SOWONAI_TEMPERATURE=0.7
```

## ì‚¬ìš© ì˜ˆì‹œ

### 1. ë²•ë¥  ë¬¸ì„œ ë¶„ì„
```javascript
const result = await workflow.ask("ë¯¸êµ­ì´ ì™œ ì´ ë²•ì•ˆì„ ë°œì˜í–ˆì„ê¹Œ?");
```

ì˜ˆìƒ ì‘ë‹µ:
```json
{
  "answer": "ë¯¸êµ­ì€ êµ­ê°€ ê²½ìŸë ¥ ê°•í™”ì™€ ê¸°ìˆ  í˜ì‹ ì„ ìœ„í•´ ì´ ë²•ì•ˆì„ ë°œì˜í–ˆìŠµë‹ˆë‹¤. íŠ¹íˆ AI ë° ì²¨ë‹¨ ê¸°ìˆ  ë¶„ì•¼ì—ì„œì˜ ê¸€ë¡œë²Œ ë¦¬ë”ì‹­ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ì „ëµì  ëª©ì ì´ ìˆìŠµë‹ˆë‹¤.",
  "references": [
    "ì²œì¬ë²•ì•ˆ"
  ]
}
```

### 2. ë²•ì•ˆì˜ ì£¼ìš” ì¡°í•­ ë¶„ì„
```javascript
const result = await workflow.ask("ì´ ë²•ì•ˆì˜ í•µì‹¬ ì¡°í•­ë“¤ì„ ìš”ì•½í•´ì£¼ì„¸ìš”.");
```

### 3. ë²•ì  ì˜í–¥ í‰ê°€
```javascript
const result = await workflow.ask("ì´ ë²•ì•ˆì´ ê¸°ìˆ  ê¸°ì—…ë“¤ì—ê²Œ ë¯¸ì¹  ì˜í–¥ì€ ë¬´ì—‡ì¸ê°€ìš”?");
```

### 4. êµ­ì œì  ë¹„êµ ë¶„ì„
```javascript
const result = await workflow.ask("ë‹¤ë¥¸ êµ­ê°€ë“¤ì˜ ìœ ì‚¬í•œ ë²•ì•ˆê³¼ ë¹„êµí–ˆì„ ë•Œ ì–´ë–¤ ì°¨ì´ì ì´ ìˆë‚˜ìš”?");
```

## ê³ ê¸‰ ê¸°ëŠ¥

### 1. ë¬¸ì„œ í•„í„° í…ŒìŠ¤íŠ¸
```javascript
// Base64 ì´ë¯¸ì§€ ì œê±° í…ŒìŠ¤íŠ¸
const filter = new RemoveBase64ImageFilter();
const result = filter.filter('í…ìŠ¤íŠ¸ <data:image/png;base64,iVBORw0K...> ë’¤ì˜ í…ìŠ¤íŠ¸');
// ê²°ê³¼: 'í…ìŠ¤íŠ¸  ë’¤ì˜ í…ìŠ¤íŠ¸'
```

### 2. ì‘ë‹µ í•„í„° í…ŒìŠ¤íŠ¸
```javascript
// ë§ˆí¬ë‹¤ìš´ JSON ì œê±° í…ŒìŠ¤íŠ¸
const filter = new RemoveMarkdownJsonFilter();
const markdown = '```json\n{"answer": "í…ŒìŠ¤íŠ¸ ì‘ë‹µ", "references": ["ë¬¸ì„œ1"]}\n```';
const filtered = filter.filter(markdown);
// ê²°ê³¼: '{"answer": "í…ŒìŠ¤íŠ¸ ì‘ë‹µ", "references": ["ë¬¸ì„œ1"]}'
```

### 3. í…ŒìŠ¤íŠ¸ ì¸í„°ì…‰í„° í™œìš©
```javascript
import { TestInterceptor } from './utils/TestInterceptor';

const interceptor = new TestInterceptor();
const workflow = new Workflow({
  mainWorkflow: workflowYaml,
  documents,
  interceptor: interceptor,
  config: testConfig
});

// ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ í›„
interceptor.printSummary(); // ì‹¤í–‰ ìš”ì•½ ì¶œë ¥
```

## ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ

```
ğŸ“‹ ë²•ë¥  ë¬¸ì„œ ë¶„ì„ ê²°ê³¼:

ì§ˆë¬¸: "ë¯¸êµ­ì´ ì™œ ì´ ë²•ì•ˆì„ ë°œì˜í–ˆì„ê¹Œ?"

ë‹µë³€: {
  "answer": "ë¯¸êµ­ì€ ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì²œì¬ë²•ì•ˆì„ ë°œì˜í–ˆìŠµë‹ˆë‹¤:\n\n1. **êµ­ê°€ ê²½ìŸë ¥ ê°•í™”**: ê¸€ë¡œë²Œ ê¸°ìˆ  ê²½ìŸì—ì„œ ìš°ìœ„ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´\n2. **ì¸ì¬ í™•ë³´**: ìµœê³  ìˆ˜ì¤€ì˜ ê³¼í•™ê¸°ìˆ  ì¸ì¬ë¥¼ ìœ ì¹˜í•˜ê³  ìœ¡ì„±í•˜ê¸° ìœ„í•´\n3. **í˜ì‹  ìƒíƒœê³„ êµ¬ì¶•**: ì—°êµ¬ê°œë°œê³¼ ìƒìš©í™”ë¥¼ ì—°ê²°í•˜ëŠ” ì²´ê³„ì ì¸ ì‹œìŠ¤í…œ êµ¬ì¶•\n4. **êµ­ê°€ ì•ˆë³´**: í•µì‹¬ ê¸°ìˆ  ë¶„ì•¼ì—ì„œì˜ ìì£¼ì  ì—­ëŸ‰ í™•ë³´",
  "references": [
    "ì²œì¬ë²•ì•ˆ"
  ]
}

ğŸ“Š ì‹¤í–‰ í†µê³„:
- ì´ ì‹¤í–‰ ì‹œê°„: 2.3ì´ˆ
- í† í° ì‚¬ìš©ëŸ‰: 1,247 í† í°
- ì°¸ì¡° ë¬¸ì„œ: 1ê°œ
- í•„í„° ì ìš©: 2ê°œ (ì´ë¯¸ì§€ ì œê±°, JSON ì •ë¦¬)
```

## ì›Œí¬í”Œë¡œìš° í™•ì¥

ì´ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

### 1. ë‹¤ì¤‘ ë¬¸ì„œ ë¶„ì„
```yaml
<document name="ê´€ë ¨ë²•ì•ˆ1">
  {{{documents.related_law1.content}}}
</document>
<document name="ê´€ë ¨ë²•ì•ˆ2">
  {{{documents.related_law2.content}}}
</document>
```

### 2. ì „ë¬¸ ë¶„ì•¼ë³„ ì—ì´ì „íŠ¸
- íŠ¹í—ˆ ì „ë¬¸ê°€ ì—ì´ì „íŠ¸
- ê·œì œ ë¶„ì„ ì „ë¬¸ê°€ ì—ì´ì „íŠ¸
- êµ­ì œë²• ì „ë¬¸ê°€ ì—ì´ì „íŠ¸

### 3. ë‹¨ê³„ë³„ ë¶„ì„ ì›Œí¬í”Œë¡œìš°
```yaml
nodes:
  analyze:
    type: "agent_task"
    agent: "analyzer_agent"
    next: "review"
  
  review:
    type: "agent_task"
    agent: "reviewer_agent"
    next: "summarize"
    
  summarize:
    type: "agent_task"
    agent: "summarizer_agent"
    next: "end"
```

ì´ ì›Œí¬í”Œë¡œìš°ë¥¼ í†µí•´ ë³µì¡í•œ ë²•ë¥  ë¬¸ì„œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ë¶„ì„í•˜ê³ , êµ¬ì¡°í™”ëœ ë‹µë³€ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„ë©”ì¸ ì „ë¬¸ê°€ AIì˜ ì§€ì‹ê³¼ ë¬¸ì„œ í•„í„°ë§ ê¸°ëŠ¥ì„ ê²°í•©í•˜ì—¬ ì •í™•í•˜ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë¶„ì„ ê²°ê³¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
